<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><meta name="referrer" content="no-referrer"><meta name="description" content="欢迎来到Vullfin的个人博客，这里记录我的个人生活的点点滴滴"><meta name="keywords" content="Vullfin,RPVVN,Vullfin个人博客,Vullfin技术博客,Vullfin'Blog,Vullfin,网络安全,教程,技术文章,生活记录,python,java,c++,nodejs,markdown,c,笔记,linux,window,破解,免费分享,资源,学习,心得体会,玩机,DIY"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="Vullfin'Blog" href="https://rpvvn.github.io/rss.xml"><link rel="alternate" type="application/atom+xml" title="Vullfin'Blog" href="https://rpvvn.github.io/atom.xml"><link rel="alternate" type="application/json" title="Vullfin'Blog" href="https://rpvvn.github.io/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="ensp-ospf,华为模拟器ospf,ospf,ensp教程"><meta name="description" content="ensp初学者入门笔记记录"><link rel="canonical" href="https://rpvvn.github.io/2081.html"><title>eNSP基础笔记 - ensp - Study | SHARED BY Vullfin = Vullfin'Blog = It is difficult to free fools from the chains they revere_______Voltaire</title><meta name="generator" content="Hexo 5.4.2"><style>.darkmode--activated{--body-bg-color:#282828;--content-bg-color:#333;--card-bg-color:#555;--text-color:#ccc;--blockquote-color:#bbb;--link-color:#ccc;--link-hover-color:#eee;--brand-color:#ddd;--brand-hover-color:#ddd;--table-row-odd-bg-color:#282828;--table-row-hover-bg-color:#363636;--menu-item-bg-color:#555;--btn-default-bg:#222;--btn-default-color:#ccc;--btn-default-border-color:#555;--btn-default-hover-bg:#666;--btn-default-hover-color:#ccc;--btn-default-hover-border-color:#666;--highlight-background:#282b2e;--highlight-foreground:#a9b7c6;--highlight-gutter-background:#34393d;--highlight-gutter-foreground:#9ca9b6}.darkmode--activated img{opacity:.75}.darkmode--activated img:hover{opacity:.9}.darkmode--activated code{color:#69dbdc;background:0 0}button.darkmode-toggle{z-index:9999}.darkmode-ignore,img{display:flex!important}.beian img{display:inline-block!important}</style></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="col-sm-2"><div id="wave1"></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">eNSP基础笔记</h1><div class="meta"><span class="item" title="创建时间：2022-11-26 20:21:34"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">发表于</span> <time itemprop="dateCreated datePublished" datetime="2022-11-26T20:21:34+08:00">2022-11-26</time> </span><span class="item" title="本文字数"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">本文字数</span> <span>10k</span> <span class="text">字</span> </span><span class="item" title="阅读时长"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">阅读时长</span> <span>9 分钟</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">SHARED BY Vullfin</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://article.biliimg.com/bfs/article/2b786f884ddbb2f3ced5737fcd82fb1b3493141128677554.png"></li><li class="item" data-background-image="https://article.biliimg.com/bfs/article/4145bd57efec19d2cea99f9ae4a60fd73493141128677554.png"></li><li class="item" data-background-image="https://article.biliimg.com/bfs/article/94292e8c5f99511b2b2b06e320993ac53493141128677554.png"></li><li class="item" data-background-image="https://article.biliimg.com/bfs/article/1d0f43ba87127d8ac08887023c5bde593493141128677554.jpg"></li><li class="item" data-background-image="https://article.biliimg.com/bfs/article/a83151eb40eef2c02567b80a490cce803493141128677554.jpg"></li><li class="item" data-background-image="https://article.biliimg.com/bfs/article/fd4b0cc7ba758578abfd0caafd6f10be3493141128677554.jpg"></li></ul></div><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div></header><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">首页</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/Study/" itemprop="item" rel="index" title="分类于 Study"><span itemprop="name">Study</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/Study/ensp/" itemprop="item" rel="index" title="分类于 ensp"><span itemprop="name">ensp</span></a><meta itemprop="position" content="2"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://rpvvn.github.io/2081.html"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="Vullfin"><meta itemprop="description" content="It is difficult to free fools from the chains they revere_______Voltaire, 欢迎来到Vullfin的个人博客，这里记录我的个人生活的点点滴滴"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="Vullfin'Blog"></span><div class="body md" itemprop="articleBody"><h1 id="ensp"><a class="anchor" href="#ensp">#</a> eNSP</h1><h2 id="基本命令"><a class="anchor" href="#基本命令">#</a> 基本命令</h2><h2 id="ospf"><a class="anchor" href="#ospf">#</a> OSPF</h2><p>配置 ospf 时有时候计算为了方便计算开销值，通常使用</p><p><code>bandwidth-reference（OSPF）</code></p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#参考</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token operator">&lt;</span>HUAWEI<span class="token operator">></span> system-view</pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">[</span>HUAWEI<span class="token punctuation">]</span> ospf <span class="token number">100</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">[</span>HUAWEI-ospf-100<span class="token punctuation">]</span> bandwidth-reference <span class="token number">1000</span></pre></td></tr></table></figure><blockquote><p>建立 EBGP 查看 BGP 路由表 要是接收不到 Loopback 口的路由信息时候，是因为 ospf 优先级高于 BGP 协议，然后 IBGP 内路由器不会将除了本地（即下一跳地址）传出 IBGP 内部，也不会传给 EBGP 邻居，所以会导致不通。</p><p>解决办法：在你需要配置的 EBGP 路由器配置一条静态聚合路由，下一条为对端的 IBGP 路由 ip（但是这么做整体工作量会很大）</p></blockquote><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">ip</span> route-static <span class="token number">0.0</span>.0.0   <span class="token number">0.0</span>.0.0      X.X.X.X</pre></td></tr><tr><td data-num="2"></td><td><pre>                目标地址     掩码    （对端下一跳ip）</pre></td></tr></table></figure><h1><a class="anchor" href="#">#</a></h1><h2 id="bgp"><a class="anchor" href="#bgp">#</a> BGP</h2><p>内部网络时，需要配置 OSPF 路由协议，以便建立 IBGP 邻居时候发送 BGP 报文源地址的连通性</p><blockquote><p>配置 ospf 时候需要 <code>network</code> 内部的 ip 网络，不需要宣告其他的外部网络，也就是 EBGP</p></blockquote><ul><li>验证 ospf 协议：display ip routing-table protocol ospf</li></ul><blockquote><p>配置 BGP peer 时 peer 的时对端 IP 创建 BGP 对等体</p></blockquote><blockquote><p>对端的 EBGP 需要，network 不然无法建立连接。</p></blockquote><h4 id="peer-next-hop-local"><a class="anchor" href="#peer-next-hop-local">#</a> peer next-hop-local</h4><p><strong>功能</strong>：命令用来设置向 IBGP 对等体（组）通告路由时，把下一跳属性设为自身的 IP 地址。</p><p><strong>用法</strong>：<strong>peer next-hop-local</strong> 命令一般在 ASBR 上配置。当设备通过 EBGP 邻居学到路由再转发给其他 IBGP 邻居时，默认不修改下一跳，但其 EBGP 邻居发来的路由的下一跳都是其 EBGP 邻居的 Peer 地址，本端对等体所属 AS 域内的 IBGP 邻居收到这样的路由后，由于下一跳不可达导致路由无法活跃。</p><p><strong>简意</strong>：大致意思就是，他通过 EBGP 邻居学习到了路由发给了内部 IBGP ，但是发给 IBGP 他不会修改下一条，就是说内部收到了来自 EBGP 路由，但是 IBGP 不认识这个 ip，所以修改发给 IBGP 邻居的路由的下一跳是其自身的地址，IBGP 邻居收到这样的路由后（由于域内都配置了 IGP）发现下一跳可达就连通了。</p><h4 id="peer-reflect-client"><a class="anchor" href="#peer-reflect-client">#</a> peer reflect-client</h4><p><strong>功能</strong>：<strong>peer reflect-client</strong> 命令用来配置将本机作为路由反射器，并将对等体（组）作为路由反射器的客户。</p><p><strong>用法</strong>：为保证 IBGP 对等体之间的连通性，需要在 IBGP 对等体之间建立全连接关系。假设在一个 AS 内部有 n 台无线接入控制器，那么应该建立的 IBGP 连接数就为 n (n-1)/2。</p><p>当 IBGP 对等体数目很多时，对网络资源和 CPU 资源的消耗都很大。利用路由反射可以解决这一问题。为保证 IBGP 对等体之间的连通性，需要在 IBGP 对等体之间建立全连接关系。假设在一个 AS 内部有 n 台无线接入控制器，那么应该建立的 IBGP 连接数就为 n (n-1)/2。当 IBGP 对等体数目很多时，对网络资源和 CPU 资源的消耗都很大。利用路由反射可以解决这一问题。</p><p><strong>简意</strong>：IBGP 对等体之间不需要建立全连接关系，将都在相连的路由器配置为 BGP 路由反射器，其他连接过来当客户机</p><h4 id="aggregate"><a class="anchor" href="#aggregate">#</a> aggregate</h4><p><strong>功能</strong>：<strong>aggregate</strong> 命令用来在 BGP 路由表中创建一条聚合路由。</p><p><strong>用法</strong>：BGP 路由聚合分为手动聚合和自动聚合两种，<strong>aggregate</strong> 命令用于实现手动聚合。该命令可以对 BGP 本地路由表中的路由进行聚合。手动聚合后的路由的优先级高于自动聚合。</p><p>如果聚合路由中所包含的具体路由各 Origin 属性不相同，那么聚合路由的 Origin 属性按照优先级 igp &gt; egp &gt; incomplete 为准。聚合路由会携带原来所有具体路由中的团体属性。</p><p>通过设置关键字<strong> as-set</strong>，可创建一条聚合路由，该路由的自治系统 AS（Autonomous System）路径包含了具体路由的 AS 路径信息。若需聚合较多 AS 路径时，请慎用此关键字，因为当具体路由的变化较频繁时，会导致路由振荡。</p><p>关键字<strong> detail-suppressed</strong> 抑制该聚合路由所包含的所有具体路由，只发布该聚合路由。生成的聚合路由带 Atomic-aggregate 属性，并且不能携带原具体路由的团体属性。</p><p>关键字<strong> suppress-policy</strong> 能产生聚合路由，但抑制指定路由的通告。可以用<strong> route-policy</strong> 的<strong> if-match</strong> 子句有选择地抑制一些具体路由，即匹配该策略的路由将被抑制，但其它未通过策略的具体路由仍被通告。也可以通过<a target="_blank" rel="noopener" href="https://support.huawei.com/enterprise/zh/doc/EDOC1100064377?section=j16g"><strong> peer route-policy</strong></a> 命令，配置不希望发布给对等体的策略达到相同效果。</p><p>使用关键字<strong> origin-policy</strong> 仅在匹配<strong> route-policy</strong> 时才生成聚合路由。</p><p>关键字<strong> attribute-policy</strong> 可设置聚合路由的属性。如果在策略中使用命令<a target="_blank" rel="noopener" href="https://support.huawei.com/enterprise/zh/doc/EDOC1100064377?section=j17g"><strong> apply as-path</strong></a> 配置了 AS_Path 属性，且<strong> aggregate</strong> 命令设置了关键字<strong> as-set</strong>，那么策略中的<a target="_blank" rel="noopener" href="https://support.huawei.com/enterprise/zh/doc/EDOC1100064377?section=j17g"><strong> apply as-path</strong></a> 命令将不会生效。通过<a target="_blank" rel="noopener" href="https://support.huawei.com/enterprise/zh/doc/EDOC1100064377?section=j16g"><strong> peer route-policy</strong></a> 命令也可以完成同样的工作。</p><p><strong>简意</strong>： bgp 视图下用 aggregate 汇总命令配置手工路由汇总，aggregate 可以灵活指定汇总路由的目的网络掩码长度，而且不受网络地址类别的限制。</p><p>基本用法就是： <code>aggregate x.x.x.x 掩码 as-set</code></p><p>后面加 <code>detail-suppressed</code> 就是只通告汇总路由，抑制明细路由。大概就是 <code>aggregate x.x.x.x 掩码 detail-suppressed</code></p><p>1、aggregate detail-suppressed as-set 命令配置路由汇总。<br>关键字 detail-suppressed 后面 +as-set 关键字，也就是意味着汇总路由，抑制明细路由，但是 as-set 继承明细路由的路径属性，特别是 AS-Path 属性的继承，AS-Path 属性也起到防环作用。<br>2、在 aggregate 命令中使用 suppress-policy 关键字（抑制策略）。<br>这个关键字用于通过汇总路由以及被选定的明细路由，换句话说，就是有选择性地抑制明细路由。<br>3、在 aggregate 命令中使用 origin-policy 关键字。</p><h4 id="peer-route-policy"><a class="anchor" href="#peer-route-policy">#</a> peer route-policy</h4><p><strong>功能</strong>：<strong>peer route-policy</strong> 命令用来对来自对等体（组）的路由或向对等体（组）发布的路由指定 Route-Policy。</p><p><strong>用法</strong>：在创建路由策略后，使用<strong> peer route-policy</strong> 命令将路由策略应用到指定对等体上，可以对从该对等体（组）接收或向该对等体（组）发布的路由进行控制，只接收本端需要的路由或者只发布对端需要的路由，达到路由管理的目的；同时也能减小路由表的规模，减少对系统资源的消耗。</p><p><strong>peer</strong> { <em>group-name</em> | <em>ipv4-address</em> } <strong>route-policy</strong> <em>route-policy-name</em> { <strong>import</strong> | <strong>export</strong> }</p><p><strong>简意</strong>： 就上面那样</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#参考</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token comment">#对来自对等体的路由应用名为 AA 的 Route-Policy</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token operator">&lt;</span>AC660<span class="token operator"><span class="token file-descriptor important">5</span>></span> system-view</pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">[</span>AC6605<span class="token punctuation">]</span> bgp <span class="token number">100</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">[</span>AC6605-bgp<span class="token punctuation">]</span> peer <span class="token number">10.1</span>.1.2 as-number <span class="token number">200</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">[</span>AC6605-bgp<span class="token punctuation">]</span> ipv4-family unicast</pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">[</span>AC6605-bgp-af-ipv4<span class="token punctuation">]</span> peer <span class="token number">10.1</span>.1.2 route-policy AA <span class="token function">import</span></pre></td></tr></table></figure><h4 id="peer-advertise-community"><a class="anchor" href="#peer-advertise-community">#</a> peer advertise-community</h4><p><strong>功能</strong>：用来配置将团体属性发布给对等体（组）</p><p><strong>用法</strong>：通过执行<strong> peer advertise-community</strong> 命令可以控制是否将团体属性发布给对等体或对等体组。如果将团体属性发布给对等体组，则这个对等体组内的所有对等体都继承这个配置，这样可以简化路由策略的应用和降低维护管理的难度。</p><p><strong>简意</strong>：就是 BGP 团体，用了这个后，把自己团体属性发给对等体或者组啊 什么的</p><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token comment">#参考</span></pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>bgp <span class="token number">100</span> //启动BGP，指定本地AS编号，并进入BGP视图</pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp<span class="token punctuation">]</span>router-id <span class="token number">1.1</span>.1.1 //配置BGP的Router ID</pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp<span class="token punctuation">]</span>peer <span class="token number">2.2</span>.2.2 as-number <span class="token number">100</span> //创建BGP对等体</pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp<span class="token punctuation">]</span>peer <span class="token number">2.2</span>.2.2 connect-interface GigabitEthernet <span class="token number">0</span>/0/1 //指定BGP对等体之间建立TCP连接会话的源接</pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp<span class="token punctuation">]</span>peer <span class="token number">3.3</span>.3.3 ebgp-max-hop <span class="token number">1</span> //指定建立EBGP连接允许的最大跳数,缺省为1，即只能在物理直连链路上建立EBGP连接</pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp<span class="token punctuation">]</span>peer <span class="token number">2.2</span>.2.2 description a1 //配置指定对等体的描述信息</pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp<span class="token punctuation">]</span>ipv4-family multicast //进入BGP-IPv4组播地址族视图</pre></td></tr><tr><td data-num="16"></td><td><pre></pre></td></tr><tr><td data-num="17"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp-af-multicast<span class="token punctuation">]</span>peer <span class="token number">2.2</span>.2.2 <span class="token builtin class-name">enable</span> //原有的BGP对等体使能MP-BGP功能，成为MP-BGP对等体</pre></td></tr><tr><td data-num="18"></td><td><pre></pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp<span class="token punctuation">]</span>ipv6-family //进入BGP-IPv6单播地址族视图</pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp-af-ipv6<span class="token punctuation">]</span>peer <span class="token number">3.3</span>.3.3 <span class="token builtin class-name">enable</span> //原有的BGP对等体使能MP-BGP功能，成为MP-BGP对等体</pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp<span class="token punctuation">]</span>group a1 //创建对等体组</pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp<span class="token punctuation">]</span>peer a2 as-number <span class="token number">200</span> //配置EBGP对等体组的AS号</pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp<span class="token punctuation">]</span>peer <span class="token number">1.1</span>.1.1 group a1 //向对等体组中加入对等体</pre></td></tr><tr><td data-num="28"></td><td><pre></pre></td></tr><tr><td data-num="29"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp<span class="token punctuation">]</span>peer a2 connect-interface GigabitEthernet <span class="token number">0</span>/0/1 //指定BGP对等体之间建立TCP连接会话的源接口和源地址,缺省使用报文的出接口作为BGP报文的源接口</pre></td></tr><tr><td data-num="30"></td><td><pre></pre></td></tr><tr><td data-num="31"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp<span class="token punctuation">]</span>peer a2 ebgp-max-hop <span class="token number">1</span> //指定建立EBGP连接允许的最大跳数,缺省只能在物理直连链路上建立EBGP连接，EBGP连接允许的最大跳数为1</pre></td></tr><tr><td data-num="32"></td><td><pre></pre></td></tr><tr><td data-num="33"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp<span class="token punctuation">]</span>ipv4-family unicast //进入IPv4地址族视图</pre></td></tr><tr><td data-num="34"></td><td><pre></pre></td></tr><tr><td data-num="35"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp-af-ipv4<span class="token punctuation">]</span>import-route ospf <span class="token number">1</span> //配置BGP引入其他协议的路由</pre></td></tr><tr><td data-num="36"></td><td><pre></pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp-af-ipv4<span class="token punctuation">]</span>default-route imported //允许BGP引入本地IP路由表中已经存在的缺省路由</pre></td></tr><tr><td data-num="38"></td><td><pre></pre></td></tr><tr><td data-num="39"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp-af-ipv4<span class="token punctuation">]</span>network <span class="token number">10.1</span>.1.1 //配置BGP逐条引入路由表中的路由</pre></td></tr><tr><td data-num="40"></td><td><pre></pre></td></tr><tr><td data-num="41"></td><td><pre><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>display bgp peer //查看所有BGP对等体的信息</pre></td></tr><tr><td data-num="42"></td><td><pre></pre></td></tr><tr><td data-num="43"></td><td><pre><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>display bgp peer <span class="token number">10.1</span>.1.1 verbose //查看指定BGP对等体的信息</pre></td></tr><tr><td data-num="44"></td><td><pre></pre></td></tr><tr><td data-num="45"></td><td><pre><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>display bgp routing-table //查看BGP路由的信息</pre></td></tr><tr><td data-num="46"></td><td><pre></pre></td></tr><tr><td data-num="47"></td><td><pre><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>display bgp group //查看对等体组信息</pre></td></tr><tr><td data-num="48"></td><td><pre></pre></td></tr><tr><td data-num="49"></td><td><pre><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>display bgp multicast peer //查看MBGP对等体的信息</pre></td></tr><tr><td data-num="50"></td><td><pre></pre></td></tr><tr><td data-num="51"></td><td><pre><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>display bgp multicast group //查看MBGP对等体组的信息</pre></td></tr><tr><td data-num="52"></td><td><pre></pre></td></tr><tr><td data-num="53"></td><td><pre><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>display bgp multicast routing-table //查看MBGP路由表信息</pre></td></tr><tr><td data-num="54"></td><td><pre></pre></td></tr><tr><td data-num="55"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp<span class="token punctuation">]</span>peer <span class="token number">2.2</span>.2.2 password cipher abc123 //配置MD5认证密码</pre></td></tr><tr><td data-num="56"></td><td><pre></pre></td></tr><tr><td data-num="57"></td><td><pre><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>display bgp peer verbose //查看BGP对等体的认证详细信息</pre></td></tr><tr><td data-num="58"></td><td><pre></pre></td></tr><tr><td data-num="59"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp-af-ipv4<span class="token punctuation">]</span>peer <span class="token number">2.2</span>.2.2 reflect-client //置路由反射器及其客户</pre></td></tr><tr><td data-num="60"></td><td><pre></pre></td></tr><tr><td data-num="61"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp-af-ipv4<span class="token punctuation">]</span>reflector cluster-id <span class="token number">1.1</span>.1.1 //配置路由反射器的集群ID,缺省每个路由反射器使用自己的Router ID作为集群ID</pre></td></tr><tr><td data-num="62"></td><td><pre></pre></td></tr><tr><td data-num="63"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp-af-ipv4<span class="token punctuation">]</span>undo reflect between-clients //禁止客户机之间的路由反射,缺省是允许的</pre></td></tr><tr><td data-num="64"></td><td><pre></pre></td></tr><tr><td data-num="65"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp<span class="token punctuation">]</span>confederation <span class="token function">id</span> <span class="token number">1</span> //配置联盟ID,缺省未配置</pre></td></tr><tr><td data-num="66"></td><td><pre></pre></td></tr><tr><td data-num="67"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp<span class="token punctuation">]</span>confederation peer-as <span class="token number">1</span> //指定属于同一个联盟的子AS号</pre></td></tr><tr><td data-num="68"></td><td><pre></pre></td></tr><tr><td data-num="69"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp<span class="token punctuation">]</span>confederation nonstandard //配置联盟的兼容性,缺省与RFC3065一致</pre></td></tr><tr><td data-num="70"></td><td><pre></pre></td></tr><tr><td data-num="71"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp-af-ipv4<span class="token punctuation">]</span>filter-policy <span class="token number">2000</span> <span class="token builtin class-name">export</span> //基于访问控制列表ACL配置BGP对全局发布的路由信息进行过滤</pre></td></tr><tr><td data-num="72"></td><td><pre></pre></td></tr><tr><td data-num="73"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp-af-ipv4<span class="token punctuation">]</span>filter-policy ip-prefix <span class="token number">1</span> <span class="token builtin class-name">export</span> //基于地址前缀列表配置BGP对全局发布的路由信息进行过滤</pre></td></tr><tr><td data-num="74"></td><td><pre></pre></td></tr><tr><td data-num="75"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp-af-ipv4<span class="token punctuation">]</span>peer <span class="token number">2.2</span>.2.2 filter-policy <span class="token number">2000</span> <span class="token builtin class-name">export</span> //基于访问控制列表ACL配置对特定对等体（组）发布的路由信息进行过滤</pre></td></tr><tr><td data-num="76"></td><td><pre></pre></td></tr><tr><td data-num="77"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp-af-ipv4<span class="token punctuation">]</span>peer <span class="token number">2.2</span>.2.2 ip-prefix <span class="token number">1</span> <span class="token builtin class-name">export</span> //基于前缀列表配置对特定对等体（组）发布的路由信息进行过滤</pre></td></tr><tr><td data-num="78"></td><td><pre></pre></td></tr><tr><td data-num="79"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp-af-ipv4<span class="token punctuation">]</span>peer <span class="token number">2.2</span>.2.2 as-path-filter <span class="token number">1</span> <span class="token builtin class-name">export</span> //基于AS路径过滤器配置对特定对等体（组）发布的路由信息进行过滤</pre></td></tr><tr><td data-num="80"></td><td><pre></pre></td></tr><tr><td data-num="81"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp-af-ipv4<span class="token punctuation">]</span>peer <span class="token number">2.2</span>.2.2 route-policy a1 <span class="token builtin class-name">export</span> //基于Route-Policy配置对特定对等体（组）发布的路由信息进行过滤</pre></td></tr><tr><td data-num="82"></td><td><pre></pre></td></tr><tr><td data-num="83"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp-af-ipv4<span class="token punctuation">]</span>filter-policy <span class="token number">2000</span> <span class="token function">import</span> //基于访问控制列表ACL配置BGP从全局接收路由</pre></td></tr><tr><td data-num="84"></td><td><pre></pre></td></tr><tr><td data-num="85"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp-af-ipv4<span class="token punctuation">]</span>filter-policy ip-prefix <span class="token number">1</span> <span class="token function">import</span> //基于地址前缀列表配置BGP从全局接收路由</pre></td></tr><tr><td data-num="86"></td><td><pre></pre></td></tr><tr><td data-num="87"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp-af-ipv4<span class="token punctuation">]</span>peer <span class="token number">2.2</span>.2.2 filter-policy <span class="token number">2000</span> <span class="token function">import</span> //基于访问控制列表ACL配置从特定对等体（组）接收路由</pre></td></tr><tr><td data-num="88"></td><td><pre></pre></td></tr><tr><td data-num="89"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp-af-ipv4<span class="token punctuation">]</span>peer <span class="token number">2.2</span>.2.2 ip-prefix <span class="token number">1</span> <span class="token function">import</span> //基于前缀列表配置从特定对等体（组）接收路由</pre></td></tr><tr><td data-num="90"></td><td><pre></pre></td></tr><tr><td data-num="91"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp-af-ipv4<span class="token punctuation">]</span>peer <span class="token number">2.2</span>.2.2 as-path-filter <span class="token number">1</span> <span class="token function">import</span> //基于AS路径过滤器配置从特定对等体（组）接收路由</pre></td></tr><tr><td data-num="92"></td><td><pre></pre></td></tr><tr><td data-num="93"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp-af-ipv4<span class="token punctuation">]</span>peer <span class="token number">2.2</span>.2.2 route-policy a1 <span class="token function">import</span> //基于Route-Policy配置从特定对等体（组）接收路由</pre></td></tr><tr><td data-num="94"></td><td><pre></pre></td></tr><tr><td data-num="95"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp-af-ipv4<span class="token punctuation">]</span>peer <span class="token number">2.2</span>.2.2 route-limit <span class="token number">10</span> //设置允许从对等体（组）收到的路由数量</pre></td></tr><tr><td data-num="96"></td><td><pre></pre></td></tr><tr><td data-num="97"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp<span class="token punctuation">]</span>peer <span class="token number">2.2</span>.2.2 capability-advertise route-refresh //对于支持Route-refresh能力的BGP对等体使能Route-refresh能力,缺省是使能的</pre></td></tr><tr><td data-num="98"></td><td><pre></pre></td></tr><tr><td data-num="99"></td><td><pre>refresh bgp <span class="token number">2.2</span>.2.2 <span class="token builtin class-name">export</span> //触发BGP软复位</pre></td></tr><tr><td data-num="100"></td><td><pre></pre></td></tr><tr><td data-num="101"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp-af-ipv4<span class="token punctuation">]</span>peer <span class="token number">2.2</span>.2.2 keep-all-routes //对于不支持Route-refresh能力的BGP对等体保留对等体（组）的所有路由更新信息,缺省只保存来自对等体（组）的通过入口策略的路由更新信息</pre></td></tr><tr><td data-num="102"></td><td><pre></pre></td></tr><tr><td data-num="103"></td><td><pre><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>display <span class="token function">ip</span> as-path-filter //查看已配置的AS路径过滤器信息</pre></td></tr><tr><td data-num="104"></td><td><pre></pre></td></tr><tr><td data-num="105"></td><td><pre><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>display <span class="token function">ip</span> community-filter //查看已配置的扩展团体属性过滤器信息</pre></td></tr><tr><td data-num="106"></td><td><pre></pre></td></tr><tr><td data-num="107"></td><td><pre><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>display bgp routing-table as-path-filter <span class="token number">1</span> //查看与指定AS路径过滤器匹配的路由信息</pre></td></tr><tr><td data-num="108"></td><td><pre></pre></td></tr><tr><td data-num="109"></td><td><pre><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>display <span class="token function">ip</span> extcommunity-filter //查看已配置的扩展团体属性过滤器信息</pre></td></tr><tr><td data-num="110"></td><td><pre></pre></td></tr><tr><td data-num="111"></td><td><pre><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>display bgp routing-table community-filter <span class="token number">1</span> //查看匹配指定BGP团体属性过滤器的路由</pre></td></tr><tr><td data-num="112"></td><td><pre></pre></td></tr><tr><td data-num="113"></td><td><pre><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>display bgp multicast routing-table different-origin-as //查看与源AS不一致的MBGP路由</pre></td></tr><tr><td data-num="114"></td><td><pre></pre></td></tr><tr><td data-num="115"></td><td><pre><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>display bgp multicast routing-table regular-expression a1 //查看匹配AS正则表达式的MBGP路由信息</pre></td></tr><tr><td data-num="116"></td><td><pre></pre></td></tr><tr><td data-num="117"></td><td><pre><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>display bgp multicast paths //查看AS路径信息</pre></td></tr><tr><td data-num="118"></td><td><pre></pre></td></tr><tr><td data-num="119"></td><td><pre><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>display bgp multicast routing-table as-path-filter <span class="token number">1</span> //查看匹配过滤列表的MBGP路由信息</pre></td></tr><tr><td data-num="120"></td><td><pre></pre></td></tr><tr><td data-num="121"></td><td><pre><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>display bgp multicast routing-table community-filter <span class="token number">1</span> //查看匹配指定MBGP团体列表的路由</pre></td></tr><tr><td data-num="122"></td><td><pre></pre></td></tr><tr><td data-num="123"></td><td><pre><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>display bgp multicast routing-table peer <span class="token number">2.2</span>.2.2 received-routes //查看收发给指定MBGP对等体的路由信息</pre></td></tr><tr><td data-num="124"></td><td><pre></pre></td></tr><tr><td data-num="125"></td><td><pre><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>display bgp multicast network //查看发布的MBGP路由信息</pre></td></tr><tr><td data-num="126"></td><td><pre></pre></td></tr><tr><td data-num="127"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp<span class="token punctuation">]</span>timer connect-retry <span class="token number">32</span> //配置BGP全局连接重传定时器,缺省是32秒</pre></td></tr><tr><td data-num="128"></td><td><pre></pre></td></tr><tr><td data-num="129"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp<span class="token punctuation">]</span>peer <span class="token number">2.2</span>.2.2 timer connect-retry <span class="token number">32</span> //配置对等体或对等体组的连接重传定时器,缺省是32秒</pre></td></tr><tr><td data-num="130"></td><td><pre></pre></td></tr><tr><td data-num="131"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp<span class="token punctuation">]</span>timer keepalive <span class="token number">60</span> hold <span class="token number">180</span> //配置BGP定时器,合理的最大Keepalive消息发送间隔为保持时间的三分之一,缺省存活时间为60秒，保持时间为180秒</pre></td></tr><tr><td data-num="132"></td><td><pre></pre></td></tr><tr><td data-num="133"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp<span class="token punctuation">]</span>peer <span class="token number">2.2</span>.2.2 timer keepalive <span class="token number">60</span> hold <span class="token number">180</span> //配置对等体或对等体组的keepalive发送间隔和保持时间</pre></td></tr><tr><td data-num="134"></td><td><pre></pre></td></tr><tr><td data-num="135"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp-af-ipv4<span class="token punctuation">]</span>peer <span class="token number">2.2</span>.2.2 route-update-interval <span class="token number">15</span> //配置更新报文定时器,缺省IBGP对等体的更新报文定时器为15秒，EBGP对等体的更新报文定时器为30秒</pre></td></tr><tr><td data-num="136"></td><td><pre></pre></td></tr><tr><td data-num="137"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp<span class="token punctuation">]</span>undo ebgp-interface-sensitive //去使能EBGP连接快速复位,缺省情况下是使能的</pre></td></tr><tr><td data-num="138"></td><td><pre></pre></td></tr><tr><td data-num="139"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp<span class="token punctuation">]</span>nexthop recursive-lookup delay <span class="token number">5</span> //配置对紧急和非紧急迭代结果变更的延迟时间, 缺省为5秒</pre></td></tr><tr><td data-num="140"></td><td><pre></pre></td></tr><tr><td data-num="141"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp-af-ipv4<span class="token punctuation">]</span>dampening //配置BGP路由振荡抑制参数, 只对EBGP路由生效</pre></td></tr><tr><td data-num="142"></td><td><pre></pre></td></tr><tr><td data-num="143"></td><td><pre><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>display bgp routing-table dampened //查看BGP衰减的路由</pre></td></tr><tr><td data-num="144"></td><td><pre></pre></td></tr><tr><td data-num="145"></td><td><pre><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>display bgp routing-table dampening parameter //查看已配置的BGP路由衰减参数</pre></td></tr><tr><td data-num="146"></td><td><pre></pre></td></tr><tr><td data-num="147"></td><td><pre><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>display bgp routing-table flap-info //查看路由振荡统计信息</pre></td></tr><tr><td data-num="148"></td><td><pre></pre></td></tr><tr><td data-num="149"></td><td><pre><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>display bgp multicast routing-table dampened //查看MBGP衰减的路由</pre></td></tr><tr><td data-num="150"></td><td><pre></pre></td></tr><tr><td data-num="151"></td><td><pre><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>display bgp multicast routing-table dampening parameter //查看MBGP衰减参数信息</pre></td></tr><tr><td data-num="152"></td><td><pre></pre></td></tr><tr><td data-num="153"></td><td><pre><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>display bgp multicast routing-table flap-info //查看MBGP路由振荡统计信息</pre></td></tr><tr><td data-num="154"></td><td><pre></pre></td></tr><tr><td data-num="155"></td><td><pre><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>display bgp multicast routing-table flap-info regular-expression a1 //查看MBGP路由振荡统计信息</pre></td></tr><tr><td data-num="156"></td><td><pre></pre></td></tr><tr><td data-num="157"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp<span class="token punctuation">]</span>peer <span class="token number">2.2</span>.2.2 tracking //使能对于指定对等体的BGP Tracking功能,缺省未使能</pre></td></tr><tr><td data-num="158"></td><td><pre></pre></td></tr><tr><td data-num="159"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp<span class="token punctuation">]</span>peer <span class="token number">2.2</span>.2.2 bfd <span class="token builtin class-name">enable</span> //配置对等体或对等体组的BFD功能，使用缺省的BFD参数值建立BFD会话</pre></td></tr><tr><td data-num="160"></td><td><pre></pre></td></tr><tr><td data-num="161"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp<span class="token punctuation">]</span>peer <span class="token number">2.2</span>.2.2 bfd min-tx-interval <span class="token number">100</span> min-rx-interval <span class="token number">100</span> detect-multiplier <span class="token number">3</span> //指定需要建立BFD会话的各个参数值</pre></td></tr><tr><td data-num="162"></td><td><pre></pre></td></tr><tr><td data-num="163"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp<span class="token punctuation">]</span>peer <span class="token number">2.2</span>.2.2 bfd block //阻止对等体从对等体组中继承BFD功能</pre></td></tr><tr><td data-num="164"></td><td><pre></pre></td></tr><tr><td data-num="165"></td><td><pre><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>display bgp bfd session all //查看BGP建立的BFD会话信息</pre></td></tr><tr><td data-num="166"></td><td><pre></pre></td></tr><tr><td data-num="167"></td><td><pre><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>display bgp peer //看BGP对等体信息</pre></td></tr><tr><td data-num="168"></td><td><pre></pre></td></tr><tr><td data-num="169"></td><td><pre><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>display bgp group a1 //查看BGP对等体组信息</pre></td></tr><tr><td data-num="170"></td><td><pre></pre></td></tr><tr><td data-num="171"></td><td><pre><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>display bgp vpnv4 all group a1 //查看VPNv4的BGP对等体组信息</pre></td></tr><tr><td data-num="172"></td><td><pre></pre></td></tr><tr><td data-num="173"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp<span class="token punctuation">]</span>graceful-restart //使能BGP协议的GR能力,缺省被禁止</pre></td></tr><tr><td data-num="174"></td><td><pre></pre></td></tr><tr><td data-num="175"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp<span class="token punctuation">]</span>graceful-restart timer wait-for-rib <span class="token number">600</span> //</pre></td></tr><tr><td data-num="176"></td><td><pre></pre></td></tr><tr><td data-num="177"></td><td><pre>配置重启侧（Restarting Speaker）和接收侧（Receiving Speaker）等待End-of-RIB消息的时间,缺省情况下，等待End-of-RIB消息的时间为600秒</pre></td></tr><tr><td data-num="178"></td><td><pre></pre></td></tr><tr><td data-num="179"></td><td><pre><span class="token punctuation">[</span>Huawei<span class="token punctuation">]</span>display bgp peer verbose //查看BGP GR的状态</pre></td></tr><tr><td data-num="180"></td><td><pre></pre></td></tr><tr><td data-num="181"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp-af-ipv4<span class="token punctuation">]</span>summary automatic //自动配置按照自然网段聚合子网路由</pre></td></tr><tr><td data-num="182"></td><td><pre></pre></td></tr><tr><td data-num="183"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp-af-ipv4<span class="token punctuation">]</span>aggregate <span class="token number">10.1</span>.1.1 <span class="token number">16</span> //手动发布所有聚合路由和被聚合的路由</pre></td></tr><tr><td data-num="184"></td><td><pre></pre></td></tr><tr><td data-num="185"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp-af-ipv4<span class="token punctuation">]</span>aggregate <span class="token number">10.1</span>.1.1 <span class="token number">16</span> detail-suppressed //只手动发布聚合路由</pre></td></tr><tr><td data-num="186"></td><td><pre></pre></td></tr><tr><td data-num="187"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp-af-ipv4<span class="token punctuation">]</span>aggregate <span class="token number">10.1</span>.1.1 <span class="token number">16</span> suppress-policy a1 //只手工发布聚合路由和通过路由策略的被聚合的路由</pre></td></tr><tr><td data-num="188"></td><td><pre></pre></td></tr><tr><td data-num="189"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp-af-ipv4<span class="token punctuation">]</span>aggregate <span class="token number">10.1</span>.1.1 <span class="token number">16</span> as-set //只手工发布检测环路的聚合路由</pre></td></tr><tr><td data-num="190"></td><td><pre></pre></td></tr><tr><td data-num="191"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp-af-ipv4<span class="token punctuation">]</span>aggregate <span class="token number">10.1</span>.1.1 <span class="token number">16</span> attribute-policy a1 //手工设置聚合路由的属性</pre></td></tr><tr><td data-num="192"></td><td><pre></pre></td></tr><tr><td data-num="193"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp-af-ipv4<span class="token punctuation">]</span>aggregate <span class="token number">10.1</span>.1.1 <span class="token number">16</span> origin-policy a1 //只手工将通过路由策略的路由生成聚合路由</pre></td></tr><tr><td data-num="194"></td><td><pre></pre></td></tr><tr><td data-num="195"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp-af-ipv4<span class="token punctuation">]</span>peer <span class="token number">2.2</span>.2.2 default-route-advertise //向对等体或对等体组发送缺省路由</pre></td></tr><tr><td data-num="196"></td><td><pre></pre></td></tr><tr><td data-num="197"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp<span class="token punctuation">]</span>ipv4-family unicast //进入BGP-IPv4单播地址族视图</pre></td></tr><tr><td data-num="198"></td><td><pre></pre></td></tr><tr><td data-num="199"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp<span class="token punctuation">]</span>ipv4-family vpn-instance <span class="token number">1</span> //进入BGP-VPN实例IPv4地址族视图</pre></td></tr><tr><td data-num="200"></td><td><pre></pre></td></tr><tr><td data-num="201"></td><td><pre><span class="token punctuation">[</span>Huawei-bgp<span class="token punctuation">]</span>ipv4-family multicast //进入BGP-IPv4组播地址族视图</pre></td></tr><tr><td data-num="202"></td><td><pre></pre></td></tr><tr><td data-num="203"></td><td><pre>reset bgp all //复位BGP连接, 会导致交换机之间的BGP Peer关系中断</pre></td></tr><tr><td data-num="204"></td><td><pre></pre></td></tr><tr><td data-num="205"></td><td><pre>reset bgp <span class="token number">100</span> //复位与指定AS之间的BGP连接</pre></td></tr><tr><td data-num="206"></td><td><pre></pre></td></tr><tr><td data-num="207"></td><td><pre>reset bgp <span class="token number">2.2</span>.2.2 //复位与指定对等体的BGP连接</pre></td></tr><tr><td data-num="208"></td><td><pre></pre></td></tr><tr><td data-num="209"></td><td><pre>reset bgp external //复位所有EBGP连接</pre></td></tr><tr><td data-num="210"></td><td><pre></pre></td></tr><tr><td data-num="211"></td><td><pre>reset bgp group a1 //复位与指定对等体组的BGP连接</pre></td></tr><tr><td data-num="212"></td><td><pre></pre></td></tr><tr><td data-num="213"></td><td><pre>reset bgp internal //复位所有IBGP连接</pre></td></tr><tr><td data-num="214"></td><td><pre></pre></td></tr><tr><td data-num="215"></td><td><pre>reset bgp multicast <span class="token number">2.2</span>.2.2 //复位指定对等体间的MBGP连接</pre></td></tr><tr><td data-num="216"></td><td><pre></pre></td></tr><tr><td data-num="217"></td><td><pre>reset bgp multicast all //复位所有MBGP连接</pre></td></tr><tr><td data-num="218"></td><td><pre></pre></td></tr><tr><td data-num="219"></td><td><pre>reset bgp multicast group a1 //复位同一对等体组内所有对等体间的MBGP连接</pre></td></tr><tr><td data-num="220"></td><td><pre></pre></td></tr><tr><td data-num="221"></td><td><pre>reset bgp multicast external //复位外部连接</pre></td></tr><tr><td data-num="222"></td><td><pre></pre></td></tr><tr><td data-num="223"></td><td><pre>reset bgp multicast internal //复位内部连接</pre></td></tr></table></figure><h3 id="bgp反射路由"><a class="anchor" href="#bgp反射路由">#</a> BGP 反射路由</h3><p>反射路由当他接收到应该路由之后，就会将这个路由反射给其他的客户端、非客户端、以及其他的 EBGP</p><div class="tags"><a href="/tags/ensp%E7%AC%94%E8%AE%B0/" rel="tag"><i class="ic i-tag"></i> ensp笔记</a></div></div><footer><div class="meta"><span class="item"><span class="icon"><i class="ic i-calendar-check"></i> </span><span class="text">更新于</span> <time title="修改时间：2025-04-10 18:28:41" itemprop="dateModified" datetime="2025-04-10T18:28:41+08:00">2025-04-10</time> </span><span id="2081.html" class="item leancloud_visitors" data-flag-title="eNSP基础笔记" title="阅读次数"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">阅读次数</span> <span class="leancloud-visitors-count"></span> <span class="text">次</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="Vullfin 微信支付"><p>微信支付</p></div><div><img data-src="/images/alipay.png" alt="Vullfin 支付宝"><p>支付宝</p></div><div><img data-src="/images/paypal.png" alt="Vullfin 贝宝"><p>贝宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>本文作者： </strong>Vullfin <i class="ic i-at"><em>@</em></i>Vullfin'Blog</li><li class="link"><strong>本文链接：</strong> <a href="https://rpvvn.github.io/2081.html" title="eNSP基础笔记">https://rpvvn.github.io/2081.html</a></li><li class="license"><strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/28419.html" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;article.biliimg.com&#x2F;bfs&#x2F;article&#x2F;fd4b0cc7ba758578abfd0caafd6f10be3493141128677554.jpg" title="eNSP华为模拟器——链路聚合"><span class="type">上一篇</span> <span class="category"><i class="ic i-flag"></i> ensp</span><h3>eNSP华为模拟器——链路聚合</h3></a></div><div class="item right"><a href="/24884.html" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;article.biliimg.com&#x2F;bfs&#x2F;article&#x2F;031bb8f5ebd806d0819217865581a4553493141128677554.jpg" title="Linux笔记"><span class="type">下一篇</span> <span class="category"><i class="ic i-flag"></i> Linux</span><h3>Linux笔记</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="文章目录"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#ensp"><span class="toc-number">1.</span> <span class="toc-text">eNSP</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E5%91%BD%E4%BB%A4"><span class="toc-number">1.1.</span> <span class="toc-text">基本命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ospf"><span class="toc-number">1.2.</span> <span class="toc-text">OSPF</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link"><span class="toc-number">2.</span> <span class="toc-text"></span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#bgp"><span class="toc-number">2.1.</span> <span class="toc-text">BGP</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#peer-next-hop-local"><span class="toc-number">2.1.0.1.</span> <span class="toc-text">peer next-hop-local</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#peer-reflect-client"><span class="toc-number">2.1.0.2.</span> <span class="toc-text">peer reflect-client</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#aggregate"><span class="toc-number">2.1.0.3.</span> <span class="toc-text">aggregate</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#peer-route-policy"><span class="toc-number">2.1.0.4.</span> <span class="toc-text">peer route-policy</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#peer-advertise-community"><span class="toc-number">2.1.0.5.</span> <span class="toc-text">peer advertise-community</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bgp%E5%8F%8D%E5%B0%84%E8%B7%AF%E7%94%B1"><span class="toc-number">2.1.1.</span> <span class="toc-text">BGP 反射路由</span></a></li></ol></li></ol></div><div class="related panel pjax" data-title="系列文章"><ul><li><a href="/28419.html" rel="bookmark" title="eNSP华为模拟器——链路聚合">eNSP华为模拟器——链路聚合</a></li><li class="active"><a href="/2081.html" rel="bookmark" title="eNSP基础笔记">eNSP基础笔记</a></li><li><a href="/28903.html" rel="bookmark" title="eNSP笔记——BGP">eNSP笔记——BGP</a></li><li><a href="/15917.html" rel="bookmark" title="eNSP笔记">eNSP笔记</a></li><li><a href="/13397.html" rel="bookmark" title="eNSP-ACL记录">eNSP-ACL记录</a></li><li><a href="/33676.html" rel="bookmark" title="eNSP笔记之OSPF虚链路实验">eNSP笔记之OSPF虚链路实验</a></li><li><a href="/37288.html" rel="bookmark" title="eNSP-MUX-VLAN">eNSP-MUX-VLAN</a></li><li><a href="/18126.html" rel="bookmark" title="eNSP-SuperVlan">eNSP-SuperVlan</a></li><li><a href="/63063.html" rel="bookmark" title="eNSP-VlanMapping">eNSP-VlanMapping</a></li><li><a href="/40757.html" rel="bookmark" title="eNSP-网络拥塞管理与拥塞避免">eNSP-网络拥塞管理与拥塞避免</a></li><li><a href="/19519.html" rel="bookmark" title="eNSP-IPSecVPN">eNSP-IPSecVPN</a></li><li><a href="/64031.html" rel="bookmark" title="组建直连式二层无线局域网">组建直连式二层无线局域网</a></li></ul></div><div class="overview panel" data-title="站点概览"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Vullfin" data-src="/images/avatar.jpg"><p class="name" itemprop="name">Vullfin</p><div class="description" itemprop="description">欢迎来到Vullfin的个人博客，这里记录我的个人生活的点点滴滴</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">47</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">18</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">23</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL3JwdnZu" title="https:&#x2F;&#x2F;github.com&#x2F;rpvvn"><i class="ic i-github"></i></span> <span class="exturl item email" data-url="bWFpbHRvOnJwd25fYmxvZ0BvdXRsb29rLmNvbQ==" title="mailto:rpwn_blog@outlook.com"><i class="ic i-envelope"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-user"></i>关于</a><ul class="submenu"><li class="item"><a href="/about/" rel="section"><i class="ic i-heartbeat"></i>关于</a></li><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>友链</a></li><li class="item"><a href="/sitemap.xml" rel="section"><i class="ic i-sitemap"></i>sitemap</a></li></ul></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item"><a href="/UpDate/" rel="section"><i class="ic i-arrow-up"></i>UPDate</a></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/28419.html" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/24884.html" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>随机文章</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/Study/" title="分类于 Study">Study</a> <i class="ic i-angle-right"></i> <a href="/categories/Study/ensp/" title="分类于 ensp">ensp</a></div><span><a href="/2081.html" title="eNSP基础笔记">eNSP基础笔记</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Study/" title="分类于 Study">Study</a> <i class="ic i-angle-right"></i> <a href="/categories/Study/Window/" title="分类于 Window">Window</a></div><span><a href="/35842.html" title="小技巧">小技巧</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Study/" title="分类于 Study">Study</a> <i class="ic i-angle-right"></i> <a href="/categories/Study/ensp/" title="分类于 ensp">ensp</a></div><span><a href="/33676.html" title="eNSP笔记之OSPF虚链路实验">eNSP笔记之OSPF虚链路实验</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Study/" title="分类于 Study">Study</a> <i class="ic i-angle-right"></i> <a href="/categories/Study/ensp/" title="分类于 ensp">ensp</a></div><span><a href="/64031.html" title="组建直连式二层无线局域网">组建直连式二层无线局域网</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Study/" title="分类于 Study">Study</a> <i class="ic i-angle-right"></i> <a href="/categories/Study/Blog/" title="分类于 Blog">Blog</a></div><span><a href="/43290.html" title="hexo博客文章">hexo博客文章</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Study/" title="分类于 Study">Study</a> <i class="ic i-angle-right"></i> <a href="/categories/Study/Python/" title="分类于 Python">Python</a></div><span><a href="/29610.html" title="Python原创力">Python原创力</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Study/" title="分类于 Study">Study</a> <i class="ic i-angle-right"></i> <a href="/categories/Study/Window/" title="分类于 Window">Window</a></div><span><a href="/59456.html" title="快速解除文件占用">快速解除文件占用</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Life/" title="分类于 Life">Life</a></div><span><a href="/55073.html" title="实习好无聊">实习好无聊</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Study/" title="分类于 Study">Study</a> <i class="ic i-angle-right"></i> <a href="/categories/Study/Window/" title="分类于 Window">Window</a></div><span><a href="/8164.html" title="window删除工具使用体验">window删除工具使用体验</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/Study/" title="分类于 Study">Study</a> <i class="ic i-angle-right"></i> <a href="/categories/Study/Blog/" title="分类于 Blog">Blog</a></div><span><a href="/36579.html" title="博客创建心得">博客创建心得</a></span></li></ul></div><div><h2>最新评论</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2022 – <span itemprop="copyrightYear">2025</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Vullfin @ SHARED BY Vullfin</span></div><span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span><script>function createtime(){var n=new Date("01/01/2022 12:00:00");now.setTime(now.getTime()+250),days=(now-n)/1e3/60/60/24,dnum=Math.floor(days),hours=(now-n)/1e3/60/60-24*dnum,hnum=Math.floor(hours),1==String(hnum).length&&(hnum="0"+hnum),minutes=(now-n)/1e3/60-1440*dnum-60*hnum,mnum=Math.floor(minutes),1==String(mnum).length&&(mnum="0"+mnum),seconds=(now-n)/1e3-86400*dnum-3600*hnum-60*mnum,snum=Math.round(seconds),1==String(snum).length&&(snum="0"+snum),document.getElementById("timeDate").innerHTML=" 本站已安全运行 "+dnum+" 天 ",document.getElementById("times").innerHTML=hnum+" 小时 "+mnum+" 分 "+snum+" 秒"}var now=new Date;setInterval("createtime()",250)</script><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">92k 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">1:23</span></div><p style="width:145px;margin:auto"><a href="https://www.foreverblog.cn/go.html" target="_blank"><img src="https://img.name/v1/7/62ca9d53e40153ea.gif" alt="" style="width:auto;height:32px" title="穿梭虫洞-随机访问十年之约友链博客"></a></p><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<a href="#">Shoka</a></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"2081.html",favicon:{show:"（●´3｀●）看片咯",hide:"(´Д｀)后台放片中！！"},search:{placeholder:"文章搜索",empty:"关于 「 ${query} 」，什么也没搜到",stats:"${time} ms 内找到 ${hits} 条结果"},valine:!0,fancybox:!0,copyright:'复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script><script data-pjax src="https://cdn.jsdelivr.net/gh/Zfour/hexo-github-calendar@1.21/hexo_githubcalendar.js"></script><script data-pjax>function GithubCalendarConfig(){
            let git_githubapiurl ="https://python-github-calendar-api.vercel.app/api?rpvvn";
            let git_color =['#ebedf0', '#fdcdec', '#fc9bd9', '#fa6ac5', '#f838b2', '#f5089f', '#c4067e', '#92055e', '#540336', '#48022f', '#30021f'];
            let git_user ="rpvvn";
            let parent_div_git = document.getElementById('recent-posts');
            let git_div_html = '<div class="recent-post-item" style="width:100%;height:auto;padding:10px;"><div id="github_loading" style="width:10%;height:100%;margin:0 auto;display: block"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"  viewBox="0 0 50 50" style="enable-background:new 0 0 50 50" xml:space="preserve"><path fill="#d0d0d0" d="M25.251,6.461c-10.318,0-18.683,8.365-18.683,18.683h4.068c0-8.071,6.543-14.615,14.615-14.615V6.461z" transform="rotate(275.098 25 25)"><animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 25 25" to="360 25 25" dur="0.6s" repeatCount="indefinite"></animateTransform></path></svg></div><div id="github_container"></div></div>';
            if(parent_div_git && location.pathname =='/rpvvn'){
                console.log('已挂载github calendar')
                // parent_div_git.innerHTML=git_div_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                parent_div_git.insertAdjacentHTML("afterbegin",git_div_html) // 有报错，但不影响使用(支持pjax跳转)
            };
            GithubCalendar(git_githubapiurl,git_color,git_user)
        }
        if(document.getElementById('recent-posts')){
            GithubCalendarConfig()
        }</script><style>#github_container{min-height:280px}@media screen and (max-width:650px){#github_container{min-height:0}}</style><style></style></body></html>